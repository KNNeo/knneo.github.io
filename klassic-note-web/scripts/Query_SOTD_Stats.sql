select 'Total Days in Song of The Day Period' as Title, CAST(JulianDay(substr(EndDate, 1, 4) || '-' || substr(EndDate, 5, 2) || '-' || substr(EndDate, 7, 2)) - JulianDay(substr(StartDate, 1, 4) || '-' || substr(StartDate, 5, 2) || '-' || substr(StartDate, 7, 2)) as INTEGER) as Value from SongAwardsPeriod where KNYEAR = 2023 and Category = 'SOTD' UNION ALL
select 'Songs of The Day Recorded' as Title, count(*) as Value from SOTD t where t.Date between (select StartDate from SongAwardsPeriod where KNYEAR = 2023 and Category = 'SOTD') and (select EndDate from SongAwardsPeriod where KNYEAR = 2023 and Category = 'SOTD') UNION ALL
select 'Songs from Past Years' as Title, count(*) as Value from SOTD t where t.Date between (select StartDate from SongAwardsPeriod where KNYEAR = 2023 and Category = 'SOTD') and (select EndDate from SongAwardsPeriod where KNYEAR = 2023 and Category = 'SOTD') and t.IsPastYear = 1 

--klassic note web friendly
select CAST(JulianDay(substr(EndDate, 1, 4) || '-' || substr(EndDate, 5, 2) || '-' || substr(EndDate, 7, 2)) - JulianDay(substr(StartDate, 1, 4) || '-' || substr(StartDate, 5, 2) || '-' || substr(StartDate, 7, 2)) as INTEGER) AS 'Number of Days in Range', (SELECT COUNT(*) FROM SOTD t WHERE t.Date > p.StartDate AND t.Date < p.EndDate) AS 'Songs Recorded', (SELECT COUNT(*) FROM SOTD t WHERE t.Date > p.StartDate AND t.Date < p.EndDate AND t.IsPastYear = 1) AS 'Past Year Songs Recorded' from SongAwardsPeriod p where p.KNYEAR = 2023 and p.Category = 'SOTD'
